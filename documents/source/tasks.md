# Tasks

A Task may be an objective, goal or task (or series of tasks); these terms may be used synonymously.

A Task must define its name; and may define its output path, requirements (files and other Tasks), a list of things to run (steps/actions), and its outputs (files).

Each task has an output path; and an input path (the folder of the Makex file in which the task was defined). 
The task output path is automatically generated, unless it is specified when defining a task.

Tasks are defined using the `task()` function.

## Task Requirements

Tasks may require other tasks and files (including files produced from other tasks).

The task(requires=[]) argument is used to define this list.


For example, the following fragment shows the various ways a task can define these dependencies:

<!--

  # expand() function to expand home directories
  expand("~/path/to/file"),
        
  # absolute path to task, a specific variant
  Task("task-name", "//path/to/task", variant={"variant-name": "variant-value"}),
  
-->
```python

task(
    name="example",
    requires=[
        # absolute path to file
        "/absolute/path/to/file",
        
        # relative path to file (from the directory of this makex file)
        "file",

        # relative path to file (from the directory of this makex file)
        "path/to/file",

        # absolute workspace path to file 
        "//path/to/file",
        
        # File local task, named "task-name" (shorthand)
        ":task-name",
        
        # Task in relative path (path/to/task/Makexfile), named "task-name" (shorthand)
        "path/to/task:task-name",
        
        # Task in workspace path (//path/to/task/Makexfile), named "task-name" (shorthand)
        "//path/to/task:task-name",
    ]
)
```


If a requirement changes, the Task requiring it will be considered "stale" or "dirty". Stale Tasks need to be executed to produce
fresh outputs.

A Task with outputs, and without any requirements will always be run.

## Input Files

Input files are any of the Tasks requirements which refer to files. 

Additionally, if the task refers to any files generated by other Tasks, those are also input files.

<!-- A task may be defined to use the output files of another Task in its inputs files or actions. -->

## Actions

A Task may defined a list of "Actions" with the `task(steps=[])` argument. Actions may be shell scripts, 
programs/executables and their arguments, or one of the built in actions.

The list of things to run is executed in order. Any errors during executing will cause Makex to stop.

## Outputs

A Task may define a list of output files. If any files are generated as part of running the Task are used, they should be specified.
The output files should be specified with paths relative to the Task's output path.

If a Task has outputs, makex will use hashes, checksums and caching strategies to see if the Task needs to be run to reproduce the outputs.

A Task with no defined output files will always be run. 
If no output files are defined, Makex will be unable to determine if the Task's outputs are stale;
and therefore will always rerun the Task when requested.

Changes to a Task definition, its dependencies, or any of its input files will cause a Task to be executed, reproducing any outputs.

<!-- 
### Declaring outputs

Tasks may define outputs in multiple ways, singular, named (singular or list), or as a list. 

#### Declaring a singular output

#### Declaring a list of outputs

#### Declaring named outputs

-->