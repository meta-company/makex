# Caches

Makex provides a uniform filesystem based cache for all of a target's outputs. 

The default location of the cache is `~/.cache/makex`. The location of this cache may be configured.

With the correct configuration, the cache may be shared by multiple processes of makex; potentially running across different machines.

## Target Output Caching

A identifier is generated for each target which we'll call `target_output_id`.

A Workspace identifier (`workspace_id`) is generated by hashing the {doc}`Workspace<workspaces>` in a stable manner (currently, by its absolute path).

<!--WORKSPACE_ID environment variable may be used to control the workspace id.-->

```{todo}

Describe the Workspace id algorithm.
```

A Target's output path may be defined by argument, otherwise it will be automatically generated.

Automatically generated paths are stored into a cache with the following structure:  

- `~/.cache/makex/`: 
  - The default path to the cache. 
  - Can be controlled with the `--cache` argument to `makex`.
  - Makex may store additional files/databases may be stored in this directory.
- `~/.cache/makex/{workspace_id}/`: 
  - The Workspace in the cache.
- `~/.cache/makex/{workspace_id}/_output_/{target_output_id}/`: 
  - The output folder of a target in the root directory of the Workspace (e.g. `//:{target_name}`).
- `~/.cache/makex/{workspace_id}/path/to/target/_output_/{target_output_id}/`:
  - The output folder of a target `//path/to/target:{target_name}` in the Workspace.


<!-- `~/.cache/makex/{workspace-id}.sqlite`: A metadata file used to store state externally.-->
